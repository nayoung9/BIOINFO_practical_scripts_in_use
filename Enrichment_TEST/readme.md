# enrichment test


Generalized Enrichment test script 

[set of target]이 특정한 [character]에 enrichment 되어있는지 여부를 검사하는 것 


**Commands**

```jsx
#perl ../general_enrichment.pl  [query_gene list ]  0.05 ./ [gene-GO]  [GO-gene]
#perl ../general_enrichment.pl  [query_target list ]  [significant level] [outdir] [target-character]  [character-target]
perl ../general_enrichment.pl  query_Example  0.05 ./ gene.tsv  GO_gene.txt
```

**Parameters**

[query_target list ]

- text file of target list (use first column as target)

    ```
    ENSSSCG00000031576
    ENSSSCG00000003493
    ENSSSCG00000023215
    ENSSSCG00000032230
    ENSSSCG00000021855
    ENSSSCG00000037803
    ENSSSCG00000032300
    ENSSSCG00000020837
    ENSSSCG00000004902
    ENSSSCG00000014869
    ```

[significant level] 

- threshold of significance

[outdir] 

- output directory

[target-character]  

- text file of target-annotated character information

    ```
    #chromosome start end id name annotated_character_list(sep=";")
    X	96543962	96744924	ENSSSCG00000012637	KLHL13	GO:0004842;GO:0016567;GO:0030496;GO:0031463;GO:0032465
    15	69648687	69648791	ENSSSCG00000037810	RF00026	-
    14	41853277	41853433	ENSSSCG00000019927	RF00003	-
    13	28045346	28053157	ENSSSCG00000031576	TMEM42	GO:0016020;GO:0016021
    X	110758748	110760321	ENSSSCG00000034882	ENSSSCG00000034882	-
    4	16389143	16391644	ENSSSCG00000021586	ZHX2	GO:0000122;GO:0003676;GO:0003677;GO:0003700;GO:0003714;GO:0005634;GO:0005654;GO:0005829;GO:0005886;GO:0006357;GO:0006402;GO:0035019;GO:0042802;GO:0042803;GO:0045665;GO:0045892;GO:0046982;GO:0060040
    12	19899226	19908901	ENSSSCG00000035057	RUNDC1	-
    X	123649780	123650987	ENSSSCG00000035115	ENSSSCG00000035115	GO:0003676
    9	113873490	113895024	ENSSSCG00000030681	MYBPH	-
    6	77780682	77913339	ENSSSCG00000003493	CAPZB	GO:0000902;GO:0003779;GO:0005737;GO:0005884;GO:0005903;GO:0008290;GO:0010591;GO:0016020;GO:0030027;GO:0030030;GO:0030032;GO:0030036;GO:0030863;GO:0051015;GO:0051016;GO:0051490
    ```

- Name of target is not used in generalized script

[character-target]

- text file of character-annotated target list information

    ```
    #character_id	annotated_target_list(sep=";")
    GO:0050129	ENSSSCG00000014933
    GO:0060345	ENSSSCG00000027157
    GO:0050061	ENSSSCG00000018041
    GO:0051712	ENSSSCG00000017755;ENSSSCG00000010271;ENSSSCG00000032963;ENSSSCG00000040377
    GO:0045334	ENSSSCG00000033876;ENSSSCG00000022659;ENSSSCG00000038929;ENSSSCG00000010687;ENSSSCG00000004272;ENSSSCG00000004478;ENSSSCG00000004587;ENSSSCG00000002011
    GO:0000381	ENSSSCG00000009946;ENSSSCG00000001564;ENSSSCG00000013233;ENSSSCG00000017155;ENSSSCG00000011395;ENSSSCG00000010877;ENSSSCG00000009868;ENSSSCG00000000288;ENSSSCG00000013476;ENSSSCG00000003748;ENSSSCG00000007362;ENSSSCG00000012271;ENSSSCG00000032726;ENSSSCG00000006809;ENSSSCG00000004050;ENSSSCG00000011121;ENSSSCG00000027608;ENSSSCG00000013375;ENSSSCG00000013421;ENSSSCG00000039876;ENSSSCG00000011134;ENSSSCG00000008484;ENSSSCG00000007917;ENSSSCG00000009906;ENSSSCG00000032781;ENSSSCG00000006618;ENSSSCG00000027905;ENSSSCG00000011420;ENSSSCG00000017795;ENSSSCG00000038304;ENSSSCG00000011720;ENSSSCG00000008048;ENSSSCG00000012676;ENSSSCG00000037517;ENSSSCG00000000152;ENSSSCG00000032583;ENSSSCG00000023357;ENSSSCG00000017626;ENSSSCG00000009505;ENSSSCG00000032437;ENSSSCG00000029236;ENSSSCG00000023122;ENSSSCG00000001928;ENSSSCG00000029954;ENSSSCG00000030225;ENSSSCG00000009845;ENSSSCG00000028663;ENSSSCG00000038455;ENSSSCG00000012727;ENSSSCG00000032092;ENSSSCG00000028509;ENSSSCG00000036592
    GO:0046959	ENSSSCG00000016521;ENSSSCG00000029037
    ```

---

APPLICATION 

LMR-motif enrichment 

- TARGET : LMR
- Character : Motif
- query list: list of LMR ids
- Materials required

    [target-character] file (tab-delimited)

    ```
    #chromosome start end **id** name annotated_character_list
    chr1 1 100 LMR_1 LMR_1 motif1;motif2;motif3
    chr1 150 200 LMR_2 LMR_2 motif3
    ```

    [character-target] file (tab-delimited)

    ```
    #character annotated_target_list
    motif1 LMR_1;LMR_5;LMR_8
    motif2 LMR_1;
    motif3 LMR_1;LMR_2
    ```
